<!DOCTYPE html>
<html>

<head lang="en">
  <meta charset="UTF-8" />
  <title>Demo</title>
  <style>
    #my-canvas {
      position: absolute;
      top: 0;
      left: 0;
      z-index: 19;
      background-color: transparent;
      border: 1px solid red;
    }
  </style>
  <script type="module">
    import { Editor } from '/dist/index.js';


    const content = [
      '![image](https://uicdn.toast.com/toastui/img/tui-editor-bi.png)',
      '',
      "1. [x] React",
      "2. [x] Vue",
      "3. [ ] Ember",
      "",
      '# Awesome Editor!',
      '',
      'It has been _released as opensource in 2018_ and has ~~continually~~ evolved to **receive 10k GitHub ⭐️ Stars**.',
      '',
      '## Create Instance',
      '',
      'You can create an instance with the following code and use `getHtml()` and `getMarkdown()` of the [Editor](https://github.com/nhn/tui.editor).',
      '',
      '```js',
      'const editor = new Editor(options);',
      '```',
      '',
      '> See the table below for default options',
      '> > More API information can be found in the document',
      '',
      '| name | type | description |',
      '| --- | --- | --- |',
      '| el | `HTMLElement` | container element |',
      '',
      '## Features',
      '',
      '* CommonMark + GFM Specifications',
      '   * Live Preview',
      '   * Scroll Sync',
      '   * Auto Indent',
      '   * Syntax Highlight',
      '        1. Markdown',
      '        2. Preview',
      '',
      '## Support Wrappers',
      '',
      '> * Wrappers',
      '>    1. [x] React',
      '>    2. [x] Vue',
      '>    3. [ ] Ember',
      '',
      "| Objective: | Link Capacity 1 CS5 2 chpid/link 16 CPUs 8 ICFs |",
      "| ---------- | ----------------------------------------------- |",
      "| Thrasher Job: | WORKLOAD.ACME.SOFPDS(ACMALLA1) |",
      "| Thrasher Rate: | /RUNWKLD 4 1 zA\_GA15\_ShrICF\_Sc1\_CS5\_DED\_R25L0243\_4ACMER1 ACMALLA1<br><br>/RUNWKLD 4 100 zA\_GA15\_ShrICF\_Sc1\_CS5\_DED\_R25L0243\_4ACMER100 ACMALLA1<br>/RUNWKLD 4 500 `zA\_GA15\_ShrICF\_Sc1\_CS5\_DED\_R25L0243\_4ACMER500 ACMALLA1` |"
    ].join('\n');

    const codeBlock = "this is codeblock 1st line\n2nd line "

    let highlight = false
    const editor = new Editor({
      el: document.querySelector('#editor'),
      previewStyle: 'vertical',
      height: '800px',
      initialEditType: 'wysiwyg',
      useCommandShortcut: true,
      extendedAutolinks: true,
      frontMatter: true,
      initialValue: content,
      customHTMLRenderer: {
        "emph": (node, context) => {
          const { origin, entering } = context
          const result = origin();
          return {
            type: entering ? 'openTag' : 'closeTag',
            attributes: highlight ? { style: 'background-color:yellow' } : {},
            tagName: 'em'
          }
        },
        "link": (node, context) => {
          const { origin, entering } = context;
          const result = origin();
          if (entering) {
            result.attributes.target = '_blank';
          }
          return result;
        },
        "image": (node, context) => {
          const { origin, entering } = context;
          const result = origin();
          if (entering) {
            result.attributes.target = '_blank';
          }
          return result;
        },
      }
    });
    window.editor = editor;
    const propertyList = [
    'color',
    'background-color',
    'font-family',
    'font-size',
    'font-weight',
    'line-height',
    'padding',
    'margin',
    'border-top',
    'border-left',
    'border-right',
    'border-bottom',
    'border-radius',
    'border-collapse',
];

    document.querySelector('#editor').addEventListener('copy', (e) => {
      const elements = document.querySelectorAll('.ProseMirror.toastui-editor-contents h1');
      for (let i = 0; i < elements.length; i++) {
        const element = elements[i];
        const style = window.getComputedStyle(element);
        const cssText = propertyList.map((property) => {
          return `${property}: ${style.getPropertyValue(property)};`;
        }).join(' ');
        console.log(cssText)
        element.setAttribute('style', cssText);
      }
    })
  </script>
</head>

<body>
  <div id="editor"></div>
  <!-- Editor -->
</body>

</html>